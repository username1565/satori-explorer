/*!
 * Satori - Satori v1.2.0 (https://Satori.gold)
 * Copyright 2020-2020 The Satori Developers
 * Licensed under MIT (https://github.com/uwxpro/Satori-explorer/blob/master/LICENSE)
 */

!function(t){let e,o,a=[],l=[],n=0,s=0,i=0,r=0;t((function(){currentPage="pool";let e=setInterval((function(){appReady&&(t.getJSON("https://raw.githubusercontent.com/cirquity/cirquity-pool-list/master/cirquity-pools.json",(function(e){console.log(e),o=e.pools,t.initPool()})),clearInterval(e))}),10);t("#calcHashRate").keyup(t.calcEstimateProfit).change(t.calcEstimateProfit),t("#calcHashUnits > li > a").click((function(e){e.preventDefault(),t("#calcHashUnit").text(t(this).text()).data("mul",t(this).data("mul")),t.calcEstimateProfit()}))})),t.initPool=function(){o.forEach((function(e){const o=e.api,a=e.url,l=e.name,n=e.type;void 0!==o&&("cryptonote-nodejs-pool"===n&&t.getPoolStatsCryptonote(o,a,l,!1),"snipa22-nodejs-pool"===n&&t.getPoolStatsSnipa(o,a,l,!1))})),setInterval((function(){s=0,n=0,a=[],o.forEach((function(e){const o=e.api,a=e.url,l=e.name,n=e.type;void 0!==o&&("cryptonote-nodejs-pool"===n&&t.getPoolStatsCryptonote(o,a,l,!0),"snipa22-nodejs-pool"===n&&t.getPoolStatsSnipa(o,a,l,!0))}))}),12e4),t.updatePool()},t.getPoolStatsCryptonote=function(e,o,l,i){i&&(s=0,n=0,a=[]),t.getJSON(t.getApiUrl(e+"/stats"),(function(e,r,c){let p=new Date(parseInt(e.pool.lastBlockFound)),u=l;0===u.length&&(u=o),void 0!==e.pool.lastBlockFoundSolo&&e.pool.lastBlockFoundSolo>e.pool.lastBlockFound&&(p=new Date(parseInt(e.pool.lastBlockFoundSolo)));let h=u.replace(" ","-").toLowerCase(),d=e.pool.miners,f=e.pool.hashrate;if(s+=parseInt(e.pool.miners),void 0!==e.pool.minersSolo&&(s+=parseInt(e.pool.minersSolo),d+=e.pool.minersSolo),n+=parseInt(e.pool.hashrate),void 0!==e.pool.hashrateSolo&&(n+=parseInt(e.pool.hashrateSolo),f+=e.pool.hashrateSolo),t.updateText("totalPoolsHashrate",t.getReadableHashRateString(n)+"/sec"),t.updateText("total_miners",t.localizeNumber(s)),i){let o=t.renderDate(p);t.updateText("height-"+h,t.localizeNumber(e.network.height)),t.updateText("hashrate-"+h,t.localizeNumber(f)+" H/s"),t.updateText("miners-"+h,t.localizeNumber(d)),t.updateText("lastFound-"+h,o),t.updateText("networkHashrate",t.getReadableHashRateString(lastStats.difficulty/blockTargetInterval)+"/sec"),t.updateText("networkDifficulty",t.getReadableDifficultyString(lastStats.difficulty,0).toString())}else t("#pools-rows").append(t.renderPoolRow(o,u,h,e,p));a.push([h,parseInt(e.pool.hashrate),""])}))},t.getPoolStatsSnipa=function(e,o,l,i){i&&(s=0,n=0,a=[]),t.getJSON(e+"/config",(function(r,c,p){t.getJSON(e+"/pool/stats",(function(c,p,u){t.getJSON(e+"/network/stats",(function(e,p,u){const h=t.elaborateSnipa(r,c,e);let d=new Date(parseInt(h.pool.lastBlockFound)),f=l;0===f.length&&(f=o);let g=f.replace(" ","-").toLowerCase();if(s+=parseInt(h.pool.miners),n+=parseInt(h.pool.hashrate),t.updateText("totalPoolsHashrate",t.getReadableHashRateString(n)+"/sec"),t.updateText("total_miners",t.localizeNumber(s)),i){let e=t.renderDate(d);t.updateText("height-"+g,t.localizeNumber(h.network.height)),t.updateText("hashrate-"+g,t.localizeNumber(h.pool.hashrate)+" H/s"),t.updateText("miners-"+g,t.localizeNumber(h.pool.miners)),t.updateText("lastFound-"+g,e),t.updateText("networkHashrate",t.getReadableHashRateString(lastStats.difficulty/blockTargetInterval)+"/sec"),t.updateText("networkDifficulty",t.getReadableDifficultyString(lastStats.difficulty,0).toString())}else t("#pools-rows").append(t.renderPoolRow(o,f,g,h,d));a.push([g,parseInt(h.pool.hashrate),""])}))}))}))},t.elaborateSnipa=function(t,e,o){return{config:{fee:t.pps_fee,donation:t.dev_donation,minPaymentThreshold:t.min_wallet_payout},pool:{hashrate:e.pool_statistics.hashRate,miners:e.pool_statistics.miners,lastBlockFound:1e3*e.pool_statistics.lastBlockFoundTime},network:{height:o.height}}},t.updatePool=function(){t.updateText("networkHashrate",t.getReadableHashRateString(lastStats.difficulty/blockTargetInterval)+"/sec"),t.updateText("networkDifficulty",t.getReadableDifficultyString(lastStats.difficulty,0).toString()),t.getBlocks(),t.renderLastBlock()},t.getBlocks=function(){e&&e.abort(),e=t.ajax({url:api+"/json_rpc",method:"POST",data:JSON.stringify({jsonrpc:"2.0",id:"getBlocks",method:"f_blocks_list_json",params:{height:lastStats.height-1}}),dataType:"json",cache:"false",success:function(e){e.result&&t.when(t.renderBlocks(e.result.blocks)).then((function(){setTimeout((function(){t.calcAvgHashRate()}),100)}))}})},t.renderBlocks=function(t){for(let e=0;e<t.length;e++){const o=t[e];l.push(parseInt(o.difficulty))}},t.renderLastBlock=function(){t.ajax({url:api+"/json_rpc",method:"POST",data:JSON.stringify({jsonrpc:"2.0",id:"lastBlock",method:"getlastblockheader",params:{}}),dataType:"json",cache:"false",success:function(e){let o=e.result.block_header.hash;t.ajax({url:api+"/json_rpc",method:"POST",data:JSON.stringify({jsonrpc:"2.0",id:"block",method:"f_block_json",params:{hash:o}}),dataType:"json",cache:"false",success:function(t){const e=t.result.block;i=parseInt(e.baseReward)}})}})},t.renderPoolRow=function(e,o,a,l,n){let s=t.renderDate(n),i=[],r=l.pool.miners,c=l.pool.hashrate;return void 0!==l.pool.minersSolo&&(r+=l.pool.minersSolo),void 0!==l.pool.hashrateSolo&&(c+=l.pool.hashrateSolo),i.push("<tr>"),i.push('<th scope="row" id="host-'+a+'"><a target="_blank" href="'+e+'">'+o+"</a></th>"),i.push('<td id="height-'+a+'" class="height">'+t.localizeNumber(l.network.height)+"</td>"),i.push('<td id="hashrate-'+a+'">'+t.localizeNumber(c)+" H/s</td>"),i.push('<td id="miners-'+a+'">'+t.localizeNumber(r)+"</td>"),i.push('<td id="totalFee-'+a+'">'+t.calculateTotalFee(l)+"%</td>"),i.push('<td id="minPayout-'+a+'">'+t.getReadableCoins(l.config.minPaymentThreshold,2)+"</td>"),i.push('<td><span id="lastFound-'+a+'">'+s+"</span></td>"),i.push("</tr>"),i.join("")},t.calcAvgHashRate=function(){let e=l.reduce((function(t,e){return t+e}),0);r=Math.round(e/l.length);blockTargetInterval;t.updateText("avgDifficulty",t.getReadableDifficultyString(r,0).toString()),t.updateText("avgHashrate",t.getReadableHashRateString(r/blockTargetInterval))},t.calcEstimateProfit=function(){try{let e=Math.pow(1024,parseInt(t("#calcHashUnit").data("mul"))),o=parseFloat(t("#calcHashRate").val())*e,a=86400*o/r*i;if(console.log(e,o,a,i),a)return void t.updateText("calcHashAmount",t.getReadableCoins(a,2,!0))}catch(t){}t.updateText("calcHashAmount","0")},t.calculateTotalFee=function(t){let e=t.config.fee;for(let o in t.config.donation)t.config.donation.hasOwnProperty(o)&&(e+=t.config.donation[o]);return e},t.getApiUrl=function(t){let e=t;return-1===t.indexOf("https")&&(e="/api/node/?url="+encodeURIComponent(t)),e},t.translateAPI2=function(t){return{network:{height:""},pool:{hashrate:t.pool_statistics.hashRate,miners:t.pool_statistics.miners},config:{minPaymentThreshold:""}}}}(jQuery);
